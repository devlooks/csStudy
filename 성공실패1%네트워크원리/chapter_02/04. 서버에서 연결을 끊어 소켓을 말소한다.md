### 1. 데이터 보내기를 완료 했을 때 연결을 끝는다.

- 데이터가 완료된 상태 : 웹서버에 리퀘스트 메시지를 보내고, 서버가 이것에 응답하여 응답 메시지를 반송완료 된것.

- 끊기 단계  
  - 서버 측
    1. 서버측 Socket 라이브러리에서 close 호출
    2. 서버측 프로토콜 스택이 TCP 헤더 만듬
    3. TCP 헤더에 컨트롤비트 FIN 비트 1설정 및 클라이언트에 송신 동시에 서버측에서 끊기 단계 들어갔다는 것을 기록
  
  - 클라이언트 측
    1. FIN 1을 설정한 TCP 헤더 도착
    2. 프로토콜 스택이 서버측에서 연결 끊기 동작 시작한 것을 기록
    3. 패킷 수신 확인을 위해 ACK 번호 서버측 반송
    4. read 호출 
    5. 수신 버퍼에 데이터 가 남아있으면 전달, 없으면 전달하지 않음.
    6. 수신 완료를 어플리케이션에 알림
    7. 클라이언트 close 호출
    8. 서버측에 FIN 1 인 TCP헤더 전송
    9. 서버측으로 부터 ACK 1인 TCP헤더 수신시, 종료.

### 2. 소켓을 말소한다.

- 수신 완료후, 소켓을 필요없지만, 잠시 대기하다, 소켓 제거 
  - 송신측으로부터 ACK가 정상 반송을 기다림

- 바로 말소시, 잘못된 소켓으로 FIN 1이 설정된 TCP헤더가 발송 에러 발생 가능성 있음.

### 3. 데이터 송수신 동작을 정리한다.

1. 접속
  
    서버 -> 클라 (SYN 1, 시퀀스 초기값, 윈도우) 

    서버 <- 클라 (ACK 번호, SYN 1, 시퀀스 초기값)

    서버 -> 클라 (ACK 번호)

2. 송수신 동작  

    서버 <- 클라 (시퀀스 번호 + 데이터)  

    서버 -> 클라 (ACK 번호, 윈도우)  

    서버 -> 클라 (시퀀스번호 + 데이터)  

    서버 <- 클라 (ACK 번호, 윈도우)  

3. 연결 끊기 동작  

    서버 -> 클라 (FIN : 1)  

    서버 <- 클라 (ACK 번호)  

    서버 <- 클라 (FIN : 1)  

    서버 -> 클라 (ACK 번호)  
  
