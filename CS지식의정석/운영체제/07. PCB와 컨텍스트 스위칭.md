# PCB와 컨텍스트 스위칭

- PCB(Process Control Block)은 운영체제에서 프로세스에 대한 메타 데이터를 저장한 데이터를 의미
- 프로세스 생성시 운영 체제는 해당 pcb 생성
- 프로그램 실행 -> 생성 -> 메모리 할당
- 프로세스의 메타 데이터들은 PCB에 저장 관리
- 프로그램 중요 정보 포함 사용자 접근 못하도록 커널 스택의 가장 앞 부분에서 관리

### 메타 데이터
- 데이터를 설명하는 작은 데이터의미

## PCB 구조
- 프로세스 스케줄링 상태, 프로세스 ID 등의 정보
- 프로세스 스케줄링 상태 : 준비, 일시중단 등..
- 프로세스 ID : 프로세스ID, 자식 프로세스ID
- 프로세스 권한 : 컴퓨터 자원 또는 I/O 디바이스에 대한 권한 정보
- 프로그램 카운터 : 프로세스에서 실행해야 할 다음 명령어의 주소에 대한 포인터
- CPU 레지스터 : 프로세스 실행을 위한, 저장 해야할
- 레지스터 에 대한 정보
- 계정 정보 : CPU 사용량, 실행한 유저의 정보
- I/O 상태 정보 : 프로세스에 할당된 I/O 디바이스 목록

## 컨텍스트 스위칭
- PCB를 교환하는 과정
- 할당 시간 끝나거나, 인터 럽트에 의해 발생
- 컨텍스트 스위칭이 빠르게 일어나 동시에 일어나는 것처럼 보임(싱글코어)
- 멀티 코어일 경우는 동시에 실행 됨

## 과정
- 프로세스 A를 실행
- 프로세스 A 멈춤
- 프로세스 A의 PCB 저장
- 프로세스 B 로드
- 프로세스 B의 PCB 저장
- 프로세스 PCB 로드

-> 순으로 작업

- 스위칭 일어날떄 발생하는 유휴 시간이 발생
- 컨텍스트 스위칭 할떄 발생하는 비용 - **캐시미스**

## 캐시미스

- 컨텍스트 스위칭이 일어날 때 프로세스가 가지고 있는  
  메모리 주소가 그대로 존재시, 잘못된 주소 변환 발생  
  그래서 메모리 주소 클리어(캐시 클리어) 과정을 가지면서 캐시미스 발생

## 스레드에서 컨텍스트 스위칭
- 컨텍스트 스위칭은 스레드에도 발생
- 스레드는 스택영역 제외한 모든 메모리 공유
- 컨텍스트 스위칭시, 비용이 적고 시간도 더 적게 걸림
